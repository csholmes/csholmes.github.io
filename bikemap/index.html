

<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>SC2SC13</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
    </style>
    <script src="data/route.js"></script>
    <script src="data/hosts.js"></script>
    <script src="data/photos.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script>

var pic_markers = [];
var pic_windows = [];
var host_markers = [];
var map;

function initialize() {

  // SETUP MAP

  var mapOptions = {
    zoom: 4,
    center: new google.maps.LatLng(38, -100),
    mapTypeId: google.maps.MapTypeId.TERRAIN,
    scaleControl: true
  };

  map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);

  // CREATE ROUTE

  var route_enc = [];

  for (i = 0; i < route.length; i++) {
        pt = new google.maps.LatLng(route[i][0],route[i][1]);
        route_enc.push(pt);
  }

  var routepath = new google.maps.Polyline({
    path: route_enc,
    geodesic: true,
    strokeColor: '#FF0000',
    strokeOpacity: 1.0,
    strokeWeight: 4
  });

  routepath.setMap(map);

  // END CREATE ROUTE

  // CREATE PHOTO THINGS

    for (i = 0; i < photos.length; i++) {

        var cont = '<div id="content" ><h1 id="firstHeading" class="firstHeading">'+photos[i].dt+'</h1><img src="https://dl.dropbox.com/s/'+photos[i].file+'" height=480 width=640><div>'+photos[i].note+'</div><button onclick="javascript:switchPic(map,'+i+','+(i+1)+')">next</button><button onclick="javascript:switchPic(map,'+i+','+(i-1)+')">previous</button></div>';

        var infowindow = new google.maps.InfoWindow({ content: cont });

        var marker = new google.maps.Marker({
            position: new google.maps.LatLng(photos[i].lat, photos[i].lon),
            map: map,
            title: 'Pic',
            icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png',
        });

        pic_markers.push(marker);
        pic_windows.push(infowindow);
    }


    for (i = 0; i < pic_markers.length; i++) {
        google.maps.event.addListener(pic_markers[i], 'click', (function(i) {
            return function() {
              pic_windows[i].open(map,pic_markers[i]);
            }
          })(i));
    }


    // hosts

    for (i = 0; i < hosts.length; i++) {
        pt = new google.maps.Marker({position: new google.maps.LatLng(hosts[i][0],hosts[i][1]), map: map, title: 'Host' });
        host_markers.push(pt);
    }
}

google.maps.event.addDomListener(window, 'load', initialize);


function switchPic(map,toclose,toopen) {
  pic_windows[toclose].close(map,pic_markers[toclose]);
  pic_windows[toopen].open(map,pic_markers[toopen]);
}


// Sets the map on all markers in the array.
function showPictures(map) {
  for (var i = 0; i < pic_markers.length; i++) {
    pic_markers[i].setMap(map);
  }
}

// Sets the map on all markers in the array.
function showHosts(map) {
  for (var i = 0; i < host_markers.length; i++) {
    host_markers[i].setMap(map);
  }
}
 
function toggleHosts(cb) {
    if (cb.checked) {
        showHosts(map);
    } else { 
        showHosts(null);
    }
}

function togglePictures(cb) {
    if (cb.checked) {
        showPictures(map);
    } else { 
        showPictures(null);
    }
}

    </script>
  </head>
  <body>
    <div style="position:absolute; top:60px; right: 20px; z-index:2;background-color: white;width: 79px;border-radius: 2px;padding: 0px;box-shadow: 0px 2px 1px #888888;">
        <form>
            <input type="checkbox" name="hosts" value="y" checked="true" onclick='toggleHosts(this);'>Hosts<br/>
            <input type="checkbox" name="pics" value="y" checked="true" onclick='togglePictures(this);'>Pictures
        </form>
    </div> 
    <div id="map-canvas"></div>
  </body>
</html>


